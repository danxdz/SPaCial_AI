@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --toast-bg: #ffffff;
    --toast-color: #374151;
  }

  [data-theme="dark"] {
    --toast-bg: #1f2937;
    --toast-color: #f9fafb;
  }

  .dark {
    --toast-bg: #1f2937;
    --toast-color: #f9fafb;
  }

  * {
    @apply border-gray-200 dark:border-gray-700;
  }

  body {
    @apply bg-gray-50 text-gray-900 dark:bg-gray-900 dark:text-gray-100;
    font-feature-settings: "rlig" 1, "calt" 1;
  }

  html {
    scroll-behavior: smooth;
  }

  /* Enable mouse wheel scrolling on select elements */
  select {
    scroll-behavior: smooth;
  }

  select:focus {
    outline: none;
  }

  /* Custom scrollbar for select elements */
  select::-webkit-scrollbar {
    width: 8px;
  }

  select::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
  }

  select::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 4px;
  }

  select::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
  }

  /* Dark mode scrollbar */
  .dark select::-webkit-scrollbar-track {
    background: #374151;
  }

  .dark select::-webkit-scrollbar-thumb {
    background: #6b7280;
  }

  .dark select::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
  }
}

@layer components {
  .btn {
    @apply inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-white px-6 py-3;
  }

  .btn-primary {
    @apply bg-blue-600 text-white hover:bg-blue-700 active:bg-blue-800;
  }

  .btn-secondary {
    @apply bg-gray-200 text-gray-900 hover:bg-gray-300 active:bg-gray-400 px-6 py-3;
  }

  .btn-success {
    @apply bg-green-600 text-white hover:bg-green-700 active:bg-green-800 px-6 py-3;
  }

  .btn-warning {
    @apply bg-yellow-600 text-white hover:bg-yellow-700 active:bg-yellow-800 px-6 py-3;
  }

  .btn-danger {
    @apply bg-red-600 text-white hover:bg-red-700 active:bg-red-800 px-6 py-3;
  }

  .card {
    @apply rounded-lg border bg-white shadow-sm;
  }

  /* Module Card Design System */
  .module-card {
    @apply bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-md transition-shadow cursor-pointer;
  }

  .module-card-image {
    @apply bg-gray-100 dark:bg-gray-700;
    aspect-ratio: 16 / 9;
  }

  .module-card-content {
    @apply p-6;
  }

  .module-card-title {
    @apply text-lg font-semibold text-gray-900 dark:text-white mb-2;
  }

  .module-card-description {
    @apply text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-2;
  }

  .module-card-stats {
    @apply flex items-center justify-between text-sm text-gray-500 dark:text-gray-400;
  }

  .module-card-stat {
    @apply flex items-center;
  }

  .module-card-stat-icon {
    @apply h-4 w-4 mr-1;
  }

  .module-card-actions {
    @apply flex space-x-2 mt-4;
  }

  .module-card-action-btn {
    @apply p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors;
  }

  .module-card-action-btn-danger {
    @apply p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors;
  }

  .module-grid {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6;
  }

  .module-empty-state {
    @apply col-span-full bg-gray-50 dark:bg-gray-700 rounded-lg p-8 text-center;
  }

  .module-empty-text {
    @apply text-gray-500 dark:text-gray-400 mb-4;
  }

  .input {
    @apply flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50;
  }

  .label {
    @apply text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70;
  }
}

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  @apply bg-gray-100;
}

::-webkit-scrollbar-thumb {
  @apply bg-gray-300 rounded-md;
}

::-webkit-scrollbar-thumb:hover {
  @apply bg-gray-400;
}

/* Chart container styles */
.chart-container {
  position: relative;
  height: 400px;
  width: 100%;
}

.chart-container canvas {
  max-height: 100% !important;
}

/* Animation classes */
.animate-fade-in {
  animation: fadeIn 0.5s ease-in-out;
}

.animate-slide-up {
  animation: slideUp 0.3s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(10px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Color blind support */
.protanopia {
  filter: url(#protanopia);
}

.deuteranopia {
  filter: url(#deuteranopia);
}

.tritanopia {
  filter: url(#tritanopia);
}

/* Color blind SVG filters */
.protanopia svg,
.deuteranopia svg,
.tritanopia svg {
  filter: inherit;
}

/* Enhanced accessibility */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Focus indicators */
.focus-visible {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
}

/* Touch-friendly buttons */
@media (hover: none) and (pointer: coarse) {
  button, .btn {
    min-height: 44px;
    min-width: 44px;
  }
}

/* Dark theme components */
.dark .card {
  @apply bg-gray-800 border-gray-700;
}

.dark .input {
  @apply bg-gray-700 border-gray-600 text-gray-100;
}

.dark .btn-secondary {
  @apply bg-gray-700 text-gray-100 hover:bg-gray-600 px-6 py-3;
}

/* Zebra stripes for tables */
.table-zebra tbody tr:nth-child(even) {
  @apply bg-gray-50 dark:bg-gray-800;
}

.table-zebra tbody tr:nth-child(odd) {
  @apply bg-white dark:bg-gray-900;
}

/* Line clamp utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ===== ACCESSIBILITY FEATURES ===== */

/* High Contrast Mode */
.high-contrast {
  /* Override Tailwind's color system for high contrast */
  --tw-bg-opacity: 1;
  --tw-text-opacity: 1;
}

/* High contrast for light theme */
.high-contrast:not(.dark) {
  background-color: #ffffff !important;
  color: #000000 !important;
}

.high-contrast:not(.dark) * {
  color: #000000 !important;
}

.high-contrast:not(.dark) button,
.high-contrast:not(.dark) .btn {
  background-color: #000000 !important;
  color: #ffffff !important;
  border: 2px solid #000000 !important;
}

.high-contrast:not(.dark) button:hover,
.high-contrast:not(.dark) .btn:hover {
  background-color: #333333 !important;
  color: #ffffff !important;
}

.high-contrast:not(.dark) input,
.high-contrast:not(.dark) select,
.high-contrast:not(.dark) textarea {
  background-color: #ffffff !important;
  color: #000000 !important;
  border: 2px solid #000000 !important;
}

.high-contrast:not(.dark) .card,
.high-contrast:not(.dark) .module-card {
  background-color: #ffffff !important;
  border: 2px solid #000000 !important;
  color: #000000 !important;
}

/* Override common Tailwind background classes for light theme */
.high-contrast:not(.dark) [class*="bg-gray-50"],
.high-contrast:not(.dark) [class*="bg-gray-100"],
.high-contrast:not(.dark) [class*="bg-gray-200"] {
  background-color: #ffffff !important;
}

/* Override common Tailwind text classes for light theme */
.high-contrast:not(.dark) [class*="text-gray-500"],
.high-contrast:not(.dark) [class*="text-gray-600"],
.high-contrast:not(.dark) [class*="text-gray-700"] {
  color: #000000 !important;
}

/* High contrast for dark theme */
.high-contrast.dark {
  background-color: #000000 !important;
  color: #ffffff !important;
}

.high-contrast.dark * {
  color: #ffffff !important;
}

.high-contrast.dark button,
.high-contrast.dark .btn {
  background-color: #ffffff !important;
  color: #000000 !important;
  border: 2px solid #ffffff !important;
}

.high-contrast.dark button:hover,
.high-contrast.dark .btn:hover {
  background-color: #cccccc !important;
  color: #000000 !important;
}

.high-contrast.dark input,
.high-contrast.dark select,
.high-contrast.dark textarea {
  background-color: #000000 !important;
  color: #ffffff !important;
  border: 2px solid #ffffff !important;
}

.high-contrast.dark .card,
.high-contrast.dark .module-card {
  background-color: #000000 !important;
  border: 2px solid #ffffff !important;
  color: #ffffff !important;
}

/* Override common Tailwind background classes for dark theme */
.high-contrast.dark [class*="bg-gray-800"],
.high-contrast.dark [class*="bg-gray-900"] {
  background-color: #000000 !important;
}

/* Override common Tailwind text classes for dark theme */
.high-contrast.dark [class*="text-gray-300"],
.high-contrast.dark [class*="text-gray-400"] {
  color: #ffffff !important;
}

/* Large Text Mode */
.large-text {
  font-size: calc(1rem * var(--accessibility-large-text, 1.25)) !important;
}

.large-text h1 { font-size: calc(2.5rem * var(--accessibility-large-text, 1.25)) !important; }
.large-text h2 { font-size: calc(2rem * var(--accessibility-large-text, 1.25)) !important; }
.large-text h3 { font-size: calc(1.75rem * var(--accessibility-large-text, 1.25)) !important; }
.large-text h4 { font-size: calc(1.5rem * var(--accessibility-large-text, 1.25)) !important; }
.large-text h5 { font-size: calc(1.25rem * var(--accessibility-large-text, 1.25)) !important; }
.large-text h6 { font-size: calc(1rem * var(--accessibility-large-text, 1.25)) !important; }

.large-text button,
.large-text .btn {
  padding: calc(0.75rem * var(--accessibility-large-text, 1.25)) calc(1.5rem * var(--accessibility-large-text, 1.25)) !important;
  font-size: calc(0.875rem * var(--accessibility-large-text, 1.25)) !important;
}

.large-text input,
.large-text select,
.large-text textarea {
  padding: calc(0.5rem * var(--accessibility-large-text, 1.25)) calc(0.75rem * var(--accessibility-large-text, 1.25)) !important;
  font-size: calc(0.875rem * var(--accessibility-large-text, 1.25)) !important;
}

/* Reduced Motion */
.reduced-motion *,
.reduced-motion *::before,
.reduced-motion *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

.reduced-motion .animate-fade-in,
.reduced-motion .animate-slide-up {
  animation: none !important;
}

/* Enhanced Focus Visibility */
.focus-visible *:focus {
  outline: 3px solid #3b82f6 !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3) !important;
}

.focus-visible button:focus,
.focus-visible .btn:focus {
  outline: 3px solid #3b82f6 !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3) !important;
}

.focus-visible input:focus,
.focus-visible select:focus,
.focus-visible textarea:focus {
  outline: 3px solid #3b82f6 !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3) !important;
}

/* Keyboard Navigation Enhancements */
.keyboard-navigation button,
.keyboard-navigation .btn,
.keyboard-navigation [role="button"],
.keyboard-navigation [tabindex] {
  min-height: 44px !important;
  min-width: 44px !important;
}

/* Icon buttons should maintain their icon size but have proper touch targets */
.keyboard-navigation button svg {
  width: 16px !important;
  height: 16px !important;
  flex-shrink: 0 !important;
}

.keyboard-navigation button:has(svg) {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 14px !important; /* (44px - 16px) / 2 = 14px padding */
}

.keyboard-navigation a {
  min-height: 44px !important;
  display: inline-flex !important;
  align-items: center !important;
}

.keyboard-navigation .module-card {
  cursor: pointer !important;
}

.keyboard-navigation .module-card:focus {
  outline: 3px solid #3b82f6 !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3) !important;
}

/* Skip Links for Screen Readers */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: #000;
  color: #fff;
  padding: 8px;
  text-decoration: none;
  z-index: 1000;
}

.skip-link:focus {
  top: 6px;
}

/* Screen Reader Only Content */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Touch-friendly improvements */
@media (hover: none) and (pointer: coarse) {
  button, .btn, [role="button"] {
    min-height: 48px !important;
    min-width: 48px !important;
  }
  
  input, select, textarea {
    min-height: 48px !important;
  }
  
  .module-card {
    padding: 1rem !important;
  }
}